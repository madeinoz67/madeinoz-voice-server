{"config":{"lang":["en"],"separator":"[\\s\\-]+","pipeline":["stopWordFilter"],"fields":{"title":{"boost":1000.0},"text":{"boost":1.0},"tags":{"boost":1000000.0}}},"docs":[{"location":"","title":"voice-server","text":"<p>Welcome to the voice-server documentation.</p>"},{"location":"#overview","title":"Overview","text":"<p>voice-server is a local-first Text-to-Speech (TTS) service built with Bun. It supports multiple backends including MLX-audio (Kokoro-82M) for fast local TTS on Apple Silicon, and Qwen TTS for custom voice cloning.</p>"},{"location":"#features","title":"Features","text":"<ul> <li>\ud83c\udf99\ufe0f Local TTS - All audio generation happens on your machine</li> <li>\ud83d\udcb0 Cost-Free - No per-character or per-minute charges</li> <li>\ud83d\udd12 Private - No data sent to external services</li> <li>\ud83d\udd0a 41 Built-in Voices - Numeric voice IDs for easy configuration</li> <li>\u26a1 Fast Streaming - Smooth real-time audio playback (RTF ~1.0x)</li> <li>\ud83c\udf0d Multi-language - English, British, Japanese, Chinese voices</li> <li>\ud83d\udcf1 macOS Integration - Native notifications and audio playback</li> </ul>"},{"location":"#quick-installation","title":"Quick Installation","text":""},{"location":"#prerequisites","title":"Prerequisites","text":"<pre><code># Install Bun (TypeScript runtime)\ncurl -fsSL https://bun.sh/install | bash\n\n# Install uv (Python package manager)\ncurl -LsSf https://astral.sh/uv/install.sh | sh\n\n# Install ffmpeg (for audio conversion)\nbrew install ffmpeg\n</code></pre>"},{"location":"#install-and-run","title":"Install and Run","text":"<pre><code># Clone and navigate to project\ncd voice-server\n\n# Install dependencies\nbun install\nuv tool install mlx-audio\n\n# Run the server\nTTS_BACKEND=mlx PORT=8888 bun run dev\n\n# Test\ncurl http://localhost:8888/health\n</code></pre> <p>For complete installation instructions, API documentation, and configuration options, see the README.</p>"},{"location":"#documentation","title":"Documentation","text":"<ul> <li>README - Main documentation with installation, API reference, and configuration</li> <li>DEVELOPMENT.md - Development setup and configuration</li> <li>VOICE_GUIDE.md - User voice configuration guide</li> <li>VOICE_QUICK_REF.md - Quick reference for all 41 voices</li> <li>KOKORO_VOICES.md - Technical voice documentation</li> <li>MIGRATION.md - ElevenLabs migration guide</li> </ul>"},{"location":"KOKORO_VOICES/","title":"Kokoro Voice Index","text":"<p>This document describes the numeric voice ID system for Kokoro-82M TTS voices.</p>"},{"location":"KOKORO_VOICES/#overview","title":"Overview","text":"<p>The voice server now uses numeric voice IDs (1-41) to select Kokoro voices. This makes it easy to configure voices in agent personalities without remembering complex voice names.</p>"},{"location":"KOKORO_VOICES/#usage","title":"Usage","text":"<p>To set a voice for an agent, use a numeric voice ID:</p> <pre><code>{\n  \"voice_id\": \"1\",\n  \"voice_name\": \"Jamie (Premium)\",\n  \"stability\": 0.5,\n  \"similarity_boost\": 0.75\n}\n</code></pre> <p>The voice_id <code>\"1\"</code> maps to <code>af_heart</code> (warm, friendly American female voice).</p>"},{"location":"KOKORO_VOICES/#voice-index","title":"Voice Index","text":""},{"location":"KOKORO_VOICES/#american-female-1-11","title":"American Female (1-11)","text":"ID Voice Description 1 af_heart Warm, friendly (default) 2 af_bella Elegant, refined 3 af_nicole Professional 4 af_sky Bright, energetic 5 af_sarah Clear, articulate 6 af_jessica Expressive 7 af_kore Soft, gentle 8 af_nova Artistic, dreamy 9 af_alloy Modern, crisp 10 af_aoede Musical, lyrical 11 af_river Flowing, calm"},{"location":"KOKORO_VOICES/#american-male-12-20","title":"American Male (12-20)","text":"ID Voice Description 12 am_michael Professional, grounded 13 am_adam Youthful, energetic 14 am_eric Friendly, warm 15 am_liam Clear, confident 16 am_fenrir Deep, authoritative 17 am_echo Resonant 18 am_onyx Bold, strong 19 am_puck Playful 20 am_santa Jolly, warm"},{"location":"KOKORO_VOICES/#british-female-21-24","title":"British Female (21-24)","text":"ID Voice Description 21 bf_emma Sophisticated, RP accent 22 bf_isabella Elegant, proper 23 bf_alice Clear, educated 24 bf_lily Soft, gentle"},{"location":"KOKORO_VOICES/#british-male-25-28","title":"British Male (25-28)","text":"ID Voice Description 25 bm_george Authoritative, RP 26 bm_lewis Confident, articulate 27 bm_daniel Professional, clear 28 bm_fable Storyteller, warm"},{"location":"KOKORO_VOICES/#japanese-female-29-32","title":"Japanese Female (29-32)","text":"ID Voice Description 29 jf_alpha Standard Japanese female 30 jf_gongitsune Character voice 31 jf_nezumi Character voice 32 jf_tebukuro Character voice"},{"location":"KOKORO_VOICES/#japanese-male-33","title":"Japanese Male (33)","text":"ID Voice Description 33 jm_kumo Standard Japanese male"},{"location":"KOKORO_VOICES/#chinese-female-34-37","title":"Chinese Female (34-37)","text":"ID Voice Description 34 zf_xiaoxiao Standard Chinese female 35 zf_xiaobei Soft, gentle 36 zf_xiaoni Young, bright 37 zf_xiaoyi Clear, articulate"},{"location":"KOKORO_VOICES/#chinese-male-38-41","title":"Chinese Male (38-41)","text":"ID Voice Description 38 zm_yunjian Standard Chinese male 39 zm_yunxi Warm, friendly 40 zm_yunxia Gentle 41 zm_yunyang Energetic"},{"location":"KOKORO_VOICES/#voice-recommendations-by-agent-type","title":"Voice Recommendations by Agent Type","text":"Agent Type Recommended Voice ID Why High-energy, fast-paced (Intern) 4 (af_sky) Bright, energetic Warm, engaging (Writer) 1 (af_heart) Warm, friendly Professional, grounded (Engineer) 12 (am_michael) Professional Mischievous, playful (Pentester) 13 (am_adam) Youthful, energetic Creative, dreamy (Artist) 8 (af_nova) Artistic Sophisticated, precise (Designer) 2 (af_bella) Elegant, refined Wise, academic (Architect) 21 (bf_emma) Sophisticated, British Confident, articulate (Researcher) 21 or 25 British, educated"},{"location":"KOKORO_VOICES/#testing","title":"Testing","text":"<p>Test a voice with curl:</p> <pre><code># Test voice ID 1 (af_heart - warm, friendly)\ncurl -s -X POST http://localhost:8888/notify \\\n  -H \"Content-Type: application/json\" \\\n  -d '{\"message\": \"This is a test of voice ID 1\", \"voice_id\": \"1\"}'\n\n# Test voice ID 13 (am_adam - youthful, energetic)\ncurl -s -X POST http://localhost:8888/notify \\\n  -H \"Content-Type: application/json\" \\\n  -d '{\"message\": \"This is a test of voice ID 13\", \"voice_id\": \"13\"}'\n\n# Test voice ID 21 (bf_emma - sophisticated British)\ncurl -s -X POST http://localhost:8888/notify \\\n  -H \"Content-Type: application/json\" \\\n  -d '{\"message\": \"This is a test of voice ID 21\", \"voice_id\": \"21\"}'\n</code></pre>"},{"location":"KOKORO_VOICES/#implementation","title":"Implementation","text":"<p>The voice index is implemented in: - <code>src/ts/constants/KOKORO_VOICES.ts</code> - Voice index definitions - <code>src/ts/services/voice-loader.ts</code> - Voice resolution logic - <code>src/ts/services/mlx-tts-client.ts</code> - TTS client integration</p>"},{"location":"KOKORO_VOICES/#future-enhancements","title":"Future Enhancements","text":"<ul> <li>Add remaining Kokoro voices (French, Spanish, Italian, Portuguese, Hindi)</li> <li>Support prosody settings for Kokoro (limited to speed parameter)</li> <li>Voice preview endpoint for auditioning voices</li> </ul>"},{"location":"MIGRATION/","title":"Migration Guide: ElevenLabs \u2192 Kokoro TTS","text":"<p>This guide helps you migrate from ElevenLabs to the local MLX-audio Kokoro TTS backend.</p>"},{"location":"MIGRATION/#quick-summary","title":"Quick Summary","text":"<p>The API is drop-in compatible. No code changes required!</p> <p>Just replace the ElevenLabs API endpoint with your local voice server.</p>"},{"location":"MIGRATION/#what-changes","title":"What Changes","text":"Aspect ElevenLabs Kokoro Voice Server Endpoint <code>api.elevenlabs.io</code> <code>localhost:8888</code> Cost $0.30/1K chars Free Latency 200-500ms ~100ms (local) Voices 90+ custom voices 41 built-in voices Privacy Cloud processing 100% local Network Required Not required"},{"location":"MIGRATION/#voice-id-mapping","title":"Voice ID Mapping","text":"<p>The voice server uses numeric voice IDs instead of ElevenLabs voice names.</p>"},{"location":"MIGRATION/#popular-mappings","title":"Popular Mappings","text":"Use Case ElevenLabs Voice Kokoro ID Kokoro Voice Default assistant <code>eleven_multilingual_v2</code> 1 af_heart Professional male <code>Josh</code> 12 am_michael Energetic female <code>Bella</code> 4 af_sky British female <code>Charlotte</code> 21 bf_emma Youthful male <code>Adam</code> 13 am_adam <p>See VOICE_QUICK_REF.md for all 41 voices.</p>"},{"location":"MIGRATION/#step-by-step-migration","title":"Step-by-Step Migration","text":""},{"location":"MIGRATION/#1-install-mlx-audio-backend","title":"1. Install MLX-audio Backend","text":"<pre><code>pipx install mlx-audio\n</code></pre>"},{"location":"MIGRATION/#2-install-voice-server","title":"2. Install Voice Server","text":""},{"location":"MIGRATION/#option-a-homebrew","title":"Option A: Homebrew","text":"<pre><code>brew tap madeinoz67/tap\nbrew install madeinoz67/tap/voice-server\n</code></pre>"},{"location":"MIGRATION/#option-b-npmbun","title":"Option B: npm/bun","text":"<pre><code>bun install -g @madeinoz67/voice-server\n# or\nnpm install -g @madeinoz67/voice-server\n</code></pre>"},{"location":"MIGRATION/#3-start-the-server","title":"3. Start the Server","text":"<pre><code># Terminal 1: Start voice server\nPORT=8888 bunx @madeinoz67/voice-server\n</code></pre>"},{"location":"MIGRATION/#4-update-your-application","title":"4. Update Your Application","text":"<p>Before (ElevenLabs): <pre><code>const response = await fetch('https://api.elevenlabs.io/v1/text-to-speech/your-voice-id', {\n  method: 'POST',\n  headers: {\n    'xi-api-key': process.env.ELEVENLABS_API_KEY,\n    'Content-Type': 'application/json',\n  },\n  body: JSON.stringify({\n    text: 'Hello world',\n    model_id: 'eleven_multilingual_v2',\n  }),\n});\n</code></pre></p> <p>After (Kokoro Voice Server): <pre><code>const response = await fetch('http://localhost:8888/notify', {\n  method: 'POST',\n  headers: {\n    'Content-Type': 'application/json',\n  },\n  body: JSON.stringify({\n    message: 'Hello world',\n    voice_id: '1',\n  }),\n});\n</code></pre></p>"},{"location":"MIGRATION/#5-remove-elevenlabs-credentials","title":"5. Remove ElevenLabs Credentials","text":"<pre><code># Remove from environment\nrm ~/.env  # or delete ELEVENLABS_API_KEY line\n\n# Or unset in current session\nunset ELEVENLABS_API_KEY\n</code></pre>"},{"location":"MIGRATION/#pai-integration","title":"PAI Integration","text":"<p>For PAI users using the <code>/notify</code> endpoint, no changes needed!</p> <p>Just ensure the voice server is running:</p> <pre><code># Test PAI notification\ncurl -X POST http://localhost:8888/notify \\\n  -H \"Content-Type: application/json\" \\\n  -d '{\"message\": \"PAI is working!\", \"voice_id\": \"1\"}'\n</code></pre>"},{"location":"MIGRATION/#voice-configuration","title":"Voice Configuration","text":""},{"location":"MIGRATION/#setting-default-voice","title":"Setting Default Voice","text":"<p>Update <code>~/.claude/skills/Agents/AgentPersonalities.md</code>:</p> <pre><code># Before\nvoices:\n  DAIV:\n    voice_id: \"eleven_multilingual_v2\"\n    elevenlabs_model: \"eleven_multilingual_v2\"\n\n# After\nvoices:\n  DAIV:\n    voice_id: \"1\"  # af_heart - warm, friendly\n</code></pre>"},{"location":"MIGRATION/#testing-different-voices","title":"Testing Different Voices","text":"<pre><code># Test voice 1 (warm female)\ncurl -X POST http://localhost:8888/notify \\\n  -d '{\"message\": \"This is voice 1\", \"voice_id\": \"1\"}'\n\n# Test voice 12 (professional male)\ncurl -X POST http://localhost:8888/notify \\\n  -d '{\"message\": \"This is voice 12\", \"voice_id\": \"12\"}'\n\n# Test voice 21 (British female)\ncurl -X POST http://localhost:8888/notify \\\n  -d '{\"message\": \"This is voice 21\", \"voice_id\": \"21\"}'\n</code></pre>"},{"location":"MIGRATION/#advanced-features","title":"Advanced Features","text":""},{"location":"MIGRATION/#pronunciation-rules","title":"Pronunciation Rules","text":"<p>Create <code>~/.claude/pronunciations.json</code>:</p> <pre><code>{\n  \"DAIV\": \"DAY-vee\",\n  \"PAI\": \"PIE\",\n  \"Kokoro\": \"ko-KO-ro\",\n  \"MLX\": \"M-L-X\"\n}\n</code></pre>"},{"location":"MIGRATION/#speed-adjustment","title":"Speed Adjustment","text":"<pre><code>const response = await fetch('http://localhost:8888/notify', {\n  method: 'POST',\n  headers: { 'Content-Type': 'application/json' },\n  body: JSON.stringify({\n    message: 'Hello world',\n    voice_id: '1',\n    voice_settings: {\n      speed: 1.2  // 20% faster\n    }\n  }),\n});\n</code></pre>"},{"location":"MIGRATION/#troubleshooting","title":"Troubleshooting","text":""},{"location":"MIGRATION/#connection-refused-error","title":"\"Connection refused\" Error","text":"<p>Problem: Can't connect to localhost:8888</p> <p>Solution: Start the voice server <pre><code>voice-server\n</code></pre></p>"},{"location":"MIGRATION/#mlx-audio-not-found","title":"\"mlx-audio not found\"","text":"<p>Problem: MLX-audio backend not installed</p> <p>Solution: Install MLX-audio <pre><code>pipx install mlx-audio\n</code></pre></p>"},{"location":"MIGRATION/#voice-sounds-different","title":"Voice sounds different","text":"<p>Problem: Kokoro voices sound different from ElevenLabs</p> <p>Solution: Try different voice IDs to find your preferred voice <pre><code># Browse all 41 voices\ncurl -X POST http://localhost:8888/notify -d '{\"message\": \"Testing\", \"voice_id\": \"N\"}'\n# Replace N with 1-41\n</code></pre></p>"},{"location":"MIGRATION/#no-audio-output","title":"No audio output","text":"<p>Problem: Text processed but no sound</p> <p>Solution: Check macOS audio <pre><code># Test system audio\nafplay /System/Library/Sounds/Ping.aiff\n\n# Check volume\nosascript -e 'get volume settings'\n</code></pre></p>"},{"location":"MIGRATION/#feature-comparison","title":"Feature Comparison","text":"Feature ElevenLabs Kokoro Voice Server Text-to-Speech \u2705 \u2705 Multiple Voices \u2705 90+ \u2705 41 Voice Cloning \u2705 \u274c SSML Support \u2705 \u274c Streaming \u2705 \u2705 Local Processing \u274c \u2705 Zero Cost \u274c \u2705 Privacy Cloud Local Multi-language \u2705 29 \u2705 4 (EN, JP, CN, BR)"},{"location":"MIGRATION/#rollback","title":"Rollback","text":"<p>If you need to rollback to ElevenLabs:</p> <ol> <li>Stop voice server: <code>pkill -f voice-server</code></li> <li>Restore ElevenLabs API key to environment</li> <li>Update application endpoints back to <code>api.elevenlabs.io</code></li> <li>Restore voice IDs to ElevenLabs voice names</li> </ol>"},{"location":"MIGRATION/#next-steps","title":"Next Steps","text":"<ol> <li>Choose your voices - Browse VOICE_QUICK_REF.md</li> <li>Configure agents - Update <code>AGENTPERSONALITIES.md</code></li> <li>Test thoroughly - Verify all agents sound good</li> <li>Remove ElevenLabs costs - Cancel subscription if desired</li> </ol>"},{"location":"MIGRATION/#support","title":"Support","text":"<p>For issues or questions: - Check README.md troubleshooting section - Review VOICE_GUIDE.md for voice configuration - Test with <code>/health</code> endpoint: <code>curl http://localhost:8888/health</code></p>"},{"location":"VOICE_EXAMPLES/","title":"Voice Configuration Examples","text":"<p>This document provides practical examples for configuring voices in your PAI agents.</p>"},{"location":"VOICE_EXAMPLES/#agent-personalities-file","title":"Agent Personalities File","text":"<p>The main configuration file is <code>~/.claude/skills/Agents/AgentPersonalities.md</code>.</p>"},{"location":"VOICE_EXAMPLES/#example-configurations","title":"Example Configurations","text":""},{"location":"VOICE_EXAMPLES/#example-1-professional-engineer","title":"Example 1: Professional Engineer","text":"<pre><code>{\n  \"voices\": {\n    \"Engineer\": {\n      \"voice_id\": \"12\",\n      \"voice_name\": \"Marcus Webb\",\n      \"name\": \"Marcus\",\n      \"description\": \"Senior engineer, steady and reliable\",\n      \"stability\": 0.50,\n      \"similarity_boost\": 0.80,\n      \"style\": 0.0,\n      \"speed\": 1.0,\n      \"use_speaker_boost\": true,\n      \"type\": \"Premium\"\n    }\n  }\n}\n</code></pre> <p>Voice 12 (am_michael): Professional, grounded American male - perfect for technical explanations.</p>"},{"location":"VOICE_EXAMPLES/#example-2-high-energy-intern","title":"Example 2: High-Energy Intern","text":"<pre><code>{\n  \"voices\": {\n    \"Intern\": {\n      \"voice_id\": \"4\",\n      \"voice_name\": \"Sky\",\n      \"name\": \"Dev Patel\",\n      \"description\": \"High-energy genius, fast learner\",\n      \"stability\": 0.18,\n      \"similarity_boost\": 0.75,\n      \"style\": 0.0,\n      \"speed\": 1.2,\n      \"use_speaker_boost\": true,\n      \"type\": \"Premium\"\n    }\n  }\n}\n</code></pre> <p>Voice 4 (af_sky): Bright, energetic American female - matches high-energy personality.</p>"},{"location":"VOICE_EXAMPLES/#example-3-sophisticated-architect","title":"Example 3: Sophisticated Architect","text":"<pre><code>{\n  \"voices\": {\n    \"Architect\": {\n      \"voice_id\": \"21\",\n      \"voice_name\": \"Emma\",\n      \"name\": \"Serena Blackwood\",\n      \"description\": \"Wise, academic, sees patterns\",\n      \"stability\": 0.75,\n      \"similarity_boost\": 0.88,\n      \"style\": 0.0,\n      \"speed\": 0.9,\n      \"use_speaker_boost\": true,\n      \"type\": \"Premium\"\n    }\n  }\n}\n</code></pre> <p>Voice 21 (bf_emma): Sophisticated British female with RP accent - conveys wisdom and authority.</p>"},{"location":"VOICE_EXAMPLES/#example-4-playful-security-researcher","title":"Example 4: Playful Security Researcher","text":"<pre><code>{\n  \"voices\": {\n    \"Pentester\": {\n      \"voice_id\": \"13\",\n      \"voice_name\": \"Adam\",\n      \"name\": \"Rook Blackburn\",\n      \"description\": \"Mischievous, finds vulnerabilities\",\n      \"stability\": 0.18,\n      \"similarity_boost\": 0.85,\n      \"style\": 0.0,\n      \"speed\": 1.3,\n      \"use_speaker_boost\": true,\n      \"type\": \"Enhanced\"\n    }\n  }\n}\n</code></pre> <p>Voice 13 (am_adam): Youthful, energetic American male - playful and fun.</p>"},{"location":"VOICE_EXAMPLES/#example-5-creative-artist","title":"Example 5: Creative Artist","text":"<pre><code>{\n  \"voices\": {\n    \"Artist\": {\n      \"voice_id\": \"8\",\n      \"voice_name\": \"Nova\",\n      \"name\": \"Priya Desai\",\n      \"description\": \"Dreamy, follows creative tangents\",\n      \"stability\": 0.20,\n      \"similarity_boost\": 0.52,\n      \"style\": 0.0,\n      \"speed\": 0.95,\n      \"use_speaker_boost\": false,\n      \"type\": \"Premium\"\n    }\n  }\n}\n</code></pre> <p>Voice 8 (af_nova): Artistic, dreamy American female - perfect for creative work.</p>"},{"location":"VOICE_EXAMPLES/#personality-to-voice-mapping-guide","title":"Personality-to-Voice Mapping Guide","text":""},{"location":"VOICE_EXAMPLES/#analyticaltechnical-agents","title":"Analytical/Technical Agents","text":"Personality Voice ID Why Engineer 12 (am_michael) Professional, grounded Architect 21 (bf_emma) Wise, authoritative British Researcher 21 or 25 Educated accent Data Analyst 3 (af_nicole) Clear, professional"},{"location":"VOICE_EXAMPLES/#creativeartistic-agents","title":"Creative/Artistic Agents","text":"Personality Voice ID Why Artist 8 (af_nova) Artistic, dreamy Designer 2 (af_bella) Elegant, refined Writer 1 (af_heart) Warm, engaging Content Creator 6 (af_jessica) Expressive"},{"location":"VOICE_EXAMPLES/#high-energyfast-agents","title":"High-Energy/Fast Agents","text":"Personality Voice ID Why Intern 4 (af_sky) Bright, energetic Startup Founder 13 (am_adam) Youthful, fast Product Manager 9 (af_alloy) Modern, crisp Developer 4 or 9 Tech-focused"},{"location":"VOICE_EXAMPLES/#securitytesting-agents","title":"Security/Testing Agents","text":"Personality Voice ID Why Pentester 13 (am_adam) Playful, mischievous QA Tester 14 (am_eric) Friendly, thorough Security Analyst 16 (am_fenrir) Deep, authoritative"},{"location":"VOICE_EXAMPLES/#academicteaching-agents","title":"Academic/Teaching Agents","text":"Personality Voice ID Why Professor 25 (bm_george) Authoritative British Tutor 1 (af_heart) Warm, encouraging Academic Writer 21 (bf_emma) Sophisticated Science Communicator 12 (am_michael) Professional, clear"},{"location":"VOICE_EXAMPLES/#speed-recommendations-by-agent-type","title":"Speed Recommendations by Agent Type","text":"<p>Different agent types benefit from different speaking speeds:</p> Agent Type Speed Voice ID Why Fast-paced (Intern, Pentester) 1.2-1.3 4, 13 Match high energy Normal (Engineer, Designer) 1.0 1, 12 Natural pace Slower (Architect, Professor) 0.85-0.95 21, 25 Convey wisdom Storytelling (Writer) 0.9-1.0 1, 28 Engaging but clear"},{"location":"VOICE_EXAMPLES/#multi-agent-voice-selection","title":"Multi-Agent Voice Selection","text":"<p>When using multiple agents in parallel, choose distinct voices:</p>"},{"location":"VOICE_EXAMPLES/#research-team-example","title":"Research Team Example","text":"<pre><code>{\n  \"voices\": {\n    \"Researcher_1\": {\n      \"voice_id\": \"3\",\n      \"voice_name\": \"Nicole\"\n    },\n    \"Researcher_2\": {\n      \"voice_id\": \"14\",\n      \"voice_name\": \"Eric\"\n    },\n    \"Researcher_3\": {\n      \"voice_id\": \"21\",\n      \"voice_name\": \"Emma\"\n    }\n  }\n}\n</code></pre> <p>Result: Three distinct voices (professional female, friendly male, sophisticated British female).</p>"},{"location":"VOICE_EXAMPLES/#debate-team-example","title":"Debate Team Example","text":"<pre><code>{\n  \"voices\": {\n    \"Debater_A\": {\n      \"voice_id\": \"12\",\n      \"voice_name\": \"Michael\"\n    },\n    \"Debater_B\": {\n      \"voice_id\": \"25\",\n      \"voice_name\": \"George\"\n    }\n  }\n}\n</code></pre> <p>Result: Two distinct male voices (American professional vs British authoritative).</p>"},{"location":"VOICE_EXAMPLES/#testing-your-configuration","title":"Testing Your Configuration","text":"<p>After updating <code>AGENTPERSONALITIES.md</code>, restart the voice server and test:</p> <pre><code># Kill existing server\npkill -f \"bun run src/ts/server.ts\"\n\n# Start with Kokoro backend\nTTS_BACKEND=mlx bun run dev\n\n# Test each agent voice\ncurl -X POST http://localhost:8889/notify \\\n  -H \"Content-Type: application/json\" \\\n  -d '{\"message\": \"This is the Engineer voice\", \"voice_id\": \"12\"}'\n\ncurl -X POST http://localhost:8889/notify \\\n  -H \"Content-Type: application/json\" \\\n  -d '{\"message\": \"This is the Intern voice\", \"voice_id\": \"4\"}'\n</code></pre>"},{"location":"VOICE_EXAMPLES/#common-patterns","title":"Common Patterns","text":""},{"location":"VOICE_EXAMPLES/#the-enterprise-suite","title":"The \"Enterprise\" Suite","text":"<p>Professional voices for business contexts:</p> Role Voice ID Voice Name CEO 16 (am_fenrir) Deep, authoritative CTO 12 (am_michael) Professional, technical Designer 2 (af_bella) Elegant, refined HR 1 (af_heart) Warm, friendly"},{"location":"VOICE_EXAMPLES/#the-creative-suite","title":"The \"Creative\" Suite","text":"<p>Artistic voices for creative work:</p> Role Voice ID Voice Name Art Director 8 (af_nova) Artistic, dreamy Copywriter 6 (af_jessica) Expressive Brand Strategist 21 (bf_emma) Sophisticated Content Creator 4 (af_sky) Bright, energetic"},{"location":"VOICE_EXAMPLES/#the-academic-suite","title":"The \"Academic\" Suite","text":"<p>Educated voices for learning contexts:</p> Role Voice ID Voice Name Professor 25 (bm_george) Authoritative British TA 14 (am_eric) Friendly, helpful Librarian 7 (af_kore) Soft, gentle Dean 21 (bf_emma) Sophisticated"},{"location":"VOICE_GUIDE/","title":"Voice Configuration Guide","text":"<p>This guide explains how to configure voices for your PAI agents using the Kokoro TTS system.</p>"},{"location":"VOICE_GUIDE/#quick-start","title":"Quick Start","text":"<p>To set a voice for an agent, use a numeric voice ID (1-41):</p> <pre><code>{\n  \"voice_id\": \"1\"\n}\n</code></pre> <p>That's it! Voice ID <code>1</code> gives you a warm, friendly American female voice.</p>"},{"location":"VOICE_GUIDE/#understanding-voice-ids","title":"Understanding Voice IDs","text":"<p>The voice server uses Kokoro-82M, a fast text-to-speech model with 41 built-in voices. Instead of remembering complex voice names, you simply use a number:</p> ID Voice Description Best For 1 af_heart Warm, friendly female General assistant 4 af_sky Bright, energetic female High-energy tasks 12 am_michael Professional male Technical explanations 13 am_adam Youthful, energetic male Playful interactions 21 bf_emma Sophisticated British female Academic content <p>See the Quick Reference for all 41 voices.</p>"},{"location":"VOICE_GUIDE/#how-to-configure-voices","title":"How to Configure Voices","text":""},{"location":"VOICE_GUIDE/#option-1-agent-personalities-file","title":"Option 1: Agent Personalities File","text":"<p>Edit <code>~/.claude/skills/Agents/AgentPersonalities.md</code>:</p> <pre><code>{\n  \"voices\": {\n    \"Engineer\": {\n      \"voice_id\": \"12\",\n      \"voice_name\": \"Professional Male\",\n      \"description\": \"Marcus Webb - steady, reliable engineer\"\n    },\n    \"Intern\": {\n      \"voice_id\": \"4\",\n      \"voice_name\": \"Energetic Female\",\n      \"description\": \"High-energy genius\"\n    }\n  }\n}\n</code></pre>"},{"location":"VOICE_GUIDE/#option-2-voice-id-in-request","title":"Option 2: Voice ID in Request","text":"<p>When sending notifications:</p> <pre><code>curl -X POST http://localhost:8888/notify \\\n  -H \"Content-Type: application/json\" \\\n  -d '{\"message\": \"Hello!\", \"voice_id\": \"1\"}'\n</code></pre>"},{"location":"VOICE_GUIDE/#option-3-environment-variable","title":"Option 3: Environment Variable","text":"<p>Set a default voice:</p> <pre><code>export DEFAULT_VOICE_ID=\"1\"\n</code></pre>"},{"location":"VOICE_GUIDE/#choosing-the-right-voice","title":"Choosing the Right Voice","text":""},{"location":"VOICE_GUIDE/#by-agent-personality","title":"By Agent Personality","text":"Agent Type Recommended IDs Why High-energy/fast 4, 9, 13 Bright, energetic delivery Professional/steady 1, 12, 14 Warm but grounded Academic/wise 21, 25 Sophisticated British accent Creative/artistic 8, 10 Dreamy, expressive Mischievous/playful 13, 19 Youthful, fun"},{"location":"VOICE_GUIDE/#by-gender","title":"By Gender","text":"<p>Female Voices: - American: IDs 1-11 - British: IDs 21-24 - Japanese: IDs 29-32 - Chinese: IDs 34-37</p> <p>Male Voices: - American: IDs 12-20 - British: IDs 25-28 - Japanese: ID 33 - Chinese: IDs 38-41</p>"},{"location":"VOICE_GUIDE/#by-accent","title":"By Accent","text":"Accent Voice IDs Characteristics American 1-20 Casual, friendly, diverse British 21-28 Sophisticated, educated Japanese 29-33 Native pronunciation Chinese 34-41 Native pronunciation"},{"location":"VOICE_GUIDE/#voice-descriptions","title":"Voice Descriptions","text":""},{"location":"VOICE_GUIDE/#american-female-1-11","title":"American Female (1-11)","text":"<ul> <li>#1 af_heart - Warm, friendly (default, great all-rounder)</li> <li>#2 af_bella - Elegant, refined</li> <li>#3 af_nicole - Professional, clear</li> <li>#4 af_sky - Bright, energetic</li> <li>#5 af_sarah - Clear, articulate</li> <li>#6 af_jessica - Expressive</li> <li>#7 af_kore - Soft, gentle</li> <li>#8 af_nova - Artistic, dreamy</li> <li>#9 af_alloy - Modern, crisp</li> <li>#10 af_aoede - Musical, lyrical</li> <li>#11 af_river - Flowing, calm</li> </ul>"},{"location":"VOICE_GUIDE/#american-male-12-20","title":"American Male (12-20)","text":"<ul> <li>#12 am_michael - Professional, grounded</li> <li>#13 am_adam - Youthful, energetic</li> <li>#14 am_eric - Friendly, warm</li> <li>#15 am_liam - Clear, confident</li> <li>#16 am_fenrir - Deep, authoritative</li> <li>#17 am_echo - Resonant</li> <li>#18 am_onyx - Bold, strong</li> <li>#19 am_puck - Playful</li> <li>#20 am_santa - Jolly, warm</li> </ul>"},{"location":"VOICE_GUIDE/#british-female-21-24","title":"British Female (21-24)","text":"<ul> <li>#21 bf_emma - Sophisticated, RP accent</li> <li>#22 bf_isabella - Elegant, proper</li> <li>#23 bf_alice - Clear, educated</li> <li>#24 bf_lily - Soft, gentle</li> </ul>"},{"location":"VOICE_GUIDE/#british-male-25-28","title":"British Male (25-28)","text":"<ul> <li>#25 bm_george - Authoritative, RP</li> <li>#26 bm_lewis - Confident, articulate</li> <li>#27 bm_daniel - Professional, clear</li> <li>#28 bm_fable - Storyteller, warm</li> </ul>"},{"location":"VOICE_GUIDE/#japanese-29-33","title":"Japanese (29-33)","text":"<ul> <li>#29 jf_alpha - Standard Japanese female</li> <li>#30-32 - Character voices</li> <li>#33 jm_kumo - Standard Japanese male</li> </ul>"},{"location":"VOICE_GUIDE/#chinese-34-41","title":"Chinese (34-41)","text":"<ul> <li>#34 zf_xiaoxiao - Standard Chinese female</li> <li>#35-37 - Variations (soft, young, clear)</li> <li>#38-41 - Male voices (standard, warm, gentle, energetic)</li> </ul>"},{"location":"VOICE_GUIDE/#testing-voices","title":"Testing Voices","text":"<p>Try different voices to find your favorite:</p> <pre><code># Test voice 1 (warm female)\ncurl -X POST http://localhost:8888/notify \\\n  -H \"Content-Type: application/json\" \\\n  -d '{\"message\": \"This is voice 1, warm and friendly\", \"voice_id\": \"1\"}'\n\n# Test voice 12 (professional male)\ncurl -X POST http://localhost:8888/notify \\\n  -H \"Content-Type: application/json\" \\\n  -d '{\"message\": \"This is voice 12, professional and grounded\", \"voice_id\": \"12\"}'\n\n# Test voice 21 (British female)\ncurl -X POST http://localhost:8888/notify \\\n  -H \"Content-Type\": application/json\" \\\n  -d '{\"message\": \"This is voice 21, sophisticated British\", \"voice_id\": \"21\"}'\n</code></pre>"},{"location":"VOICE_GUIDE/#troubleshooting","title":"Troubleshooting","text":"<p>Voice not changing? - Restart the voice server after changing <code>AGENTPERSONALITIES.md</code> - Check that the voice ID is a number between 1-41</p> <p>Audio quality issues? - Make sure AirPods or speakers are connected - Check server logs for errors</p> <p>Need more voices? - Currently 41 Kokoro voices available - More languages (French, Spanish, etc.) coming soon</p>"},{"location":"VOICE_GUIDE/#advanced-configuration","title":"Advanced Configuration","text":""},{"location":"VOICE_GUIDE/#speed-adjustment","title":"Speed Adjustment","text":"<p>Voice speed can be adjusted in the MLX client configuration:</p> <pre><code>{\n  \"speed\": 1.0\n}\n</code></pre> <ul> <li><code>0.8</code> = Slower</li> <li><code>1.0</code> = Normal (default)</li> <li><code>1.2</code> = Faster</li> </ul>"},{"location":"VOICE_GUIDE/#streaming-quality","title":"Streaming Quality","text":"<p>For smoother audio, adjust streaming interval:</p> <pre><code>export MLX_STREAMING_INTERVAL=\"0.3\"  # 300ms chunks (default)\n</code></pre> <p>Lower values = smoother streaming but more CPU usage.</p>"},{"location":"VOICE_GUIDE/#next-steps","title":"Next Steps","text":"<ol> <li>Browse the Quick Reference for all voices</li> <li>Test different voice IDs to find your favorites</li> <li>Update your agent configurations with chosen voices</li> <li>Refer to KOKORO_VOICES.md for technical details</li> </ol>"},{"location":"VOICE_QUICK_REF/","title":"Voice Quick Reference","text":"<p>Quick lookup table for all 41 Kokoro voices.</p>"},{"location":"VOICE_QUICK_REF/#how-to-use","title":"How to Use","text":"<p>Find the voice you want, then use its ID number:</p> <pre><code>{\"voice_id\": \"1\"}\n</code></pre>"},{"location":"VOICE_QUICK_REF/#quick-pick-by-personality","title":"Quick Pick by Personality","text":"Personality Use ID Voice Warm &amp; Friendly 1 af_heart High Energy 4 af_sky Professional 12 am_michael Youthful 13 am_adam Sophisticated 21 bf_emma British Male 25 bm_george Dreamy 8 af_nova Deep &amp; Strong 16 am_fenrir"},{"location":"VOICE_QUICK_REF/#complete-voice-index","title":"Complete Voice Index","text":""},{"location":"VOICE_QUICK_REF/#american-female-ids-1-11","title":"American Female (IDs 1-11)","text":"ID Name Vibe Use For 1 af_heart \ud83e\udde1 Warm, friendly Default, all-purpose 2 af_bella \u2728 Elegant, refined Professional settings 3 af_nicole \ud83d\udcbc Professional Business contexts 4 af_sky \u2600\ufe0f Bright, energetic High-energy tasks 5 af_sarah \ud83d\udce2 Clear, articulate Instructions 6 af_jessica \ud83c\udfad Expressive Storytelling 7 af_kore \ud83c\udf38 Soft, gentle Calm content 8 af_nova \ud83c\udfa8 Artistic, dreamy Creative work 9 af_alloy \ud83d\udd27 Modern, crisp Tech content 10 af_aoede \ud83c\udfb5 Musical, lyrical Poetry, lyrics 11 af_river \ud83c\udf0a Flowing, calm Meditation"},{"location":"VOICE_QUICK_REF/#american-male-ids-12-20","title":"American Male (IDs 12-20)","text":"ID Name Vibe Use For 12 am_michael \ud83d\udcbc Professional, grounded Engineering, tech 13 am_adam \u26a1 Youthful, energetic Playful content 14 am_eric \ud83d\udc4b Friendly, warm Casual help 15 am_liam \ud83d\udcaa Confident Leadership 16 am_fenrir \ud83c\udf99\ufe0f Deep, authoritative Narration 17 am_echo \ud83d\udd0a Resonant Presentations 18 am_onyx \ud83d\udee1\ufe0f Bold, strong Announcements 19 am_puck \ud83c\udccf Playful Entertainment 20 am_santa \ud83c\udf85 Jolly, warm Holiday, fun"},{"location":"VOICE_QUICK_REF/#british-female-ids-21-24","title":"British Female (IDs 21-24)","text":"ID Name Vibe Use For 21 bf_emma \ud83c\udfa9 Sophisticated, RP Academic, formal 22 bf_isabella \ud83d\udc51 Elegant, proper High-end content 23 bf_alice \ud83d\udcda Clear, educated Teaching 24 bf_lily \ud83c\udf37 Soft, gentle Soothing content"},{"location":"VOICE_QUICK_REF/#british-male-ids-25-28","title":"British Male (IDs 25-28)","text":"ID Name Vibe Use For 25 bm_george \ud83c\udf93 Authoritative, RP Expert commentary 26 bm_lewis \ud83c\udfaf Confident, articulate Presentations 27 bm_daniel \ud83d\udca1 Professional, clear Business 28 bm_fable \ud83d\udcd6 Storyteller, warm Narration"},{"location":"VOICE_QUICK_REF/#japanese-ids-29-33","title":"Japanese (IDs 29-33)","text":"ID Name Vibe Use For 29 jf_alpha \ud83c\uddef\ud83c\uddf5 Standard female Japanese content 30 jf_gongitsune \ud83e\udd8a Character Anime-style 31 jf_nezumi \ud83d\udc2d Character Anime-style 32 jf_tebukuro \ud83e\udde4 Character Anime-style 33 jm_kumo \ud83c\uddef\ud83c\uddf5 Standard male Japanese content"},{"location":"VOICE_QUICK_REF/#chinese-ids-34-41","title":"Chinese (IDs 34-41)","text":"ID Name Vibe Use For 34 zf_xiaoxiao \ud83c\udde8\ud83c\uddf3 Standard female Chinese content 35 zf_xiaobei \ud83c\udf38 Soft, gentle Calm Chinese 36 zf_xiaoni \ud83c\udf1f Young, bright Youthful Chinese 37 zf_xiaoyi \ud83d\udce2 Clear, articulate Formal Chinese 38 zm_yunjian \ud83c\udde8\ud83c\uddf3 Standard male Chinese content 39 zm_yunxi \ud83d\udc4b Warm, friendly Casual Chinese 40 zm_yunxia \ud83c\udf19 Gentle Soothing Chinese 41 zm_yunyang \u26a1 Energetic Lively Chinese"},{"location":"VOICE_QUICK_REF/#one-liner-descriptions","title":"One-Liner Descriptions","text":"<pre><code>1:  af_heart       - Warm, friendly (default)\n2:  af_bella       - Elegant, refined\n3:  af_nicole      - Professional\n4:  af_sky         - Bright, energetic\n5:  af_sarah       - Clear, articulate\n6:  af_jessica     - Expressive\n7:  af_kore        - Soft, gentle\n8:  af_nova        - Artistic, dreamy\n9:  af_alloy       - Modern, crisp\n10: af_aoede       - Musical, lyrical\n11: af_river       - Flowing, calm\n12: am_michael     - Professional, grounded\n13: am_adam        - Youthful, energetic\n14: am_eric        - Friendly, warm\n15: am_liam        - Clear, confident\n16: am_fenrir      - Deep, authoritative\n17: am_echo        - Resonant\n18: am_onyx        - Bold, strong\n19: am_puck        - Playful\n20: am_santa       - Jolly, warm\n21: bf_emma        - Sophisticated, British\n22: bf_isabella    - Elegant, proper\n23: bf_alice       - Clear, educated\n24: bf_lily        - Soft, gentle\n25: bm_george      - Authoritative, British\n26: bm_lewis       - Confident, articulate\n27: bm_daniel      - Professional, clear\n28: bm_fable       - Storyteller, warm\n29: jf_alpha       - Japanese female\n30: jf_gongitsune  - Japanese character\n31: jf_nezumi      - Japanese character\n32: jf_tebukuro    - Japanese character\n33: jm_kumo        - Japanese male\n34: zf_xiaoxiao    - Chinese female\n35: zf_xiaobei     - Soft Chinese\n36: zf_xiaoni      - Young Chinese\n37: zf_xiaoyi      - Clear Chinese\n38: zm_yunjian     - Chinese male\n39: zm_yunxi       - Warm Chinese\n40: zm_yunxia      - Gentle Chinese\n41: zm_yunyang     - Energetic Chinese\n</code></pre>"},{"location":"VOICE_QUICK_REF/#popular-combinations","title":"Popular Combinations","text":"<p>Tech Assistant: ID 12 (am_michael) - Professional, trustworthy</p> <p>Creative Muse: ID 8 (af_nova) - Artistic, dreamy</p> <p>Study Buddy: ID 4 (af_sky) - Bright, energetic</p> <p>News Reader: ID 21 (bf_emma) - Sophisticated BBC-style</p> <p>Game Character: ID 13 (am_adam) - Youthful, fun</p> <p>Meditation Guide: ID 11 (af_river) - Calm, flowing</p>"},{"location":"agent-voices/","title":"PAI Agent Voice Profiles","text":"<p>Voice configurations for PAI agents using MLX-audio Kokoro TTS.</p>"},{"location":"agent-voices/#voice-profiles","title":"Voice Profiles","text":""},{"location":"agent-voices/#jeremy-the-enthusiastic-researcher","title":"Jeremy - The Enthusiastic Researcher","text":"<p>Personality: Energetic, excited, high-energy delivery Kokoro Voice ID: 4 (af_sky) - Bright, energetic Prosody Settings: - Stability: 0.35 (very expressive) - Style: 0.50 (dramatic) - Speed: 1.10 (fast)</p>"},{"location":"agent-voices/#daniel-the-analytical-skeptic","title":"Daniel - The Analytical Skeptic","text":"<p>Personality: Measured, intellectual, British authority Kokoro Voice ID: 21 (bf_emma) - Sophisticated British Prosody Settings: - Stability: 0.70 (consistent) - Style: 0.10 (subtle) - Speed: 0.95 (measured)</p>"},{"location":"agent-voices/#aria-the-creative-visionary","title":"Aria - The Creative Visionary","text":"<p>Personality: Expressive, versatile, young creative energy Kokoro Voice ID: 4 (af_sky) - Bright, energetic Prosody Settings: - Stability: 0.40 (expressive) - Style: 0.40 (dynamic) - Speed: 1.05 (energetic)</p>"},{"location":"agent-voices/#marcus-the-professional-leader","title":"Marcus - The Professional Leader","text":"<p>Personality: Authoritative, confident, professional Kokoro Voice ID: 12 (am_michael) - Professional male Prosody Settings: - Stability: 0.60 (consistent) - Style: 0.20 (controlled) - Speed: 1.00 (steady)</p>"},{"location":"agent-voices/#rachel-the-supportive-analyst","title":"Rachel - The Supportive Analyst","text":"<p>Personality: Calm, warm, supportive Kokoro Voice ID: 1 (af_heart) - Warm, friendly Prosody Settings: - Stability: 0.55 (balanced) - Style: 0.15 (natural) - Speed: 0.95 (gentle)</p>"},{"location":"agent-voices/#usage-with-voice-server","title":"Usage with Voice Server","text":""},{"location":"agent-voices/#current-implementation-mlx-audio-kokoro","title":"Current Implementation (MLX-audio Kokoro)","text":"<p>The voice server uses MLX-audio with Kokoro-82M model:</p> <pre><code># Test different voices via /notify endpoint\ncurl -X POST http://localhost:8889/notify \\\n  -H \"Content-Type: application/json\" \\\n  -d '{\"title\": \"Test\", \"message\": \"Hello Stephen\", \"voice_id\": \"12\"}'\n</code></pre>"},{"location":"agent-voices/#voice-configuration","title":"Voice Configuration","text":"<p>Voices are configured in <code>AGENTPERSONALITIES.md</code> (or <code>docs/agent-voices.md</code>):</p> <pre><code>## marrvin\n\n**Description:** Default voice for DAIV\n**Kokoro Voice ID:** 12 (am_michael)\n\n**Prosody:** speak with moderate consistency, speak in a neutral tone, speak at a normal pace\n\n**Speed:** 1.0\n</code></pre>"},{"location":"agent-voices/#available-kokoro-voices","title":"Available Kokoro Voices","text":"<p>The server includes 41 built-in Kokoro voices:</p> ID Voice Description 1 af_heart Warm, friendly (default) 4 af_sky Bright, energetic 12 am_michael Professional male 21 bf_emma Sophisticated British <p>See <code>docs/VOICE_QUICK_REF.md</code> for complete voice listings.</p>"},{"location":"agent-voices/#prosody-translation","title":"Prosody Translation","text":"<p>Voice personality traits are translated to Kokoro prosody settings:</p> <pre><code>// Prosody settings for Kokoro\ninterface ProsodySettings {\n  stability: number;  // 0.0-1.0 (speech consistency)\n  style: number;       // 0.0-1.0 (speaking style)\n  speed: number;       // 0.5-2.0 (speaking speed)\n}\n</code></pre> <p>These settings are applied during TTS synthesis via the MLX-audio CLI.</p>"},{"location":"api/","title":"API Reference","text":"<p>The voice server provides a simple HTTP API for text-to-speech notifications and health checks.</p>"},{"location":"api/#architecture-overview","title":"Architecture Overview","text":"<p>The voice server uses a modular architecture:</p> <ul> <li>Bun Server - TypeScript HTTP API handling requests and validation</li> <li>MLX-audio - Local TTS backend using the Kokoro-82M model</li> <li>macOS Integration - Native audio playback via afplay</li> </ul>"},{"location":"api/#base-url","title":"Base URL","text":"<pre><code>http://localhost:8888\n</code></pre> <p>Default port is <code>8888</code>. Can be customized with <code>PORT</code> environment variable.</p>"},{"location":"api/#endpoints","title":"Endpoints","text":""},{"location":"api/#post-notify","title":"POST /notify","text":"<p>Send a notification with text-to-speech.</p>"},{"location":"api/#request","title":"Request","text":"<pre><code>curl -X POST http://localhost:8888/notify \\\n  -H \"Content-Type: application/json\" \\\n  -d '{\n    \"title\": \"Hello\",\n    \"message\": \"This is a test notification\",\n    \"voice_id\": \"1\",\n    \"volume\": 1.0\n  }'\n</code></pre>"},{"location":"api/#request-body","title":"Request Body","text":"Field Type Required Description <code>title</code> string No Notification title (default: \"Notification\") <code>message</code> string Yes Text to speak <code>voice_id</code> string No Numeric voice ID 1-41 (default: \"1\") <code>voice_settings</code> object No Voice configuration <code>volume</code> number No Volume 0.0-1.0 (default: 1.0) <code>voice_enabled</code> boolean No Enable TTS (default: true)"},{"location":"api/#voice-settings","title":"Voice Settings","text":"Field Type Description <code>speed</code> number Speaking speed (0.5-2.0, default: 1.0) <code>stability</code> number Speech consistency (0.0-1.0) <code>style</code> number Speaking style (0.0-1.0)"},{"location":"api/#response","title":"Response","text":"<p>Success (200):</p> <pre><code>{\n  \"status\": \"success\",\n  \"message\": \"Notification sent\"\n}\n</code></pre> <p>Error (400):</p> <pre><code>{\n  \"error\": \"Message is required\"\n}\n</code></pre>"},{"location":"api/#example","title":"Example","text":"<pre><code># Test with voice 1 (warm, friendly)\ncurl -X POST http://localhost:8888/notify \\\n  -H \"Content-Type: application/json\" \\\n  -d '{\"message\": \"Hello from Kokoro TTS!\", \"voice_id\": \"1\"}'\n\n# Test with voice 12 (professional male) and custom speed\ncurl -X POST http://localhost:8888/notify \\\n  -H \"Content-Type: application/json\" \\\n  -d '{\n    \"message\": \"This is a professional announcement\",\n    \"voice_id\": \"12\",\n    \"voice_settings\": {\"speed\": 1.1}\n  }'\n</code></pre>"},{"location":"api/#post-pai","title":"POST /pai","text":"<p>PAI-specific notification endpoint with default voice settings optimized for PAI agent voices.</p>"},{"location":"api/#request_1","title":"Request","text":"<pre><code>curl -X POST http://localhost:8888/pai \\\n  -H \"Content-Type: application/json\" \\\n  -d '{\n    \"title\": \"PAI Alert\",\n    \"message\": \"Task completed successfully\"\n  }'\n</code></pre>"},{"location":"api/#request-body_1","title":"Request Body","text":"<p>Same fields as <code>/notify</code>, but uses PAI-optimized defaults:</p> <ul> <li>Default <code>voice_id</code>: \"12\" (professional male)</li> <li>Default <code>volume</code>: 1.0</li> <li>Default <code>voice_enabled</code>: true</li> </ul>"},{"location":"api/#response_1","title":"Response","text":"<pre><code>{\n  \"status\": \"success\",\n  \"message\": \"Notification sent\"\n}\n</code></pre>"},{"location":"api/#get-health","title":"GET /health","text":"<p>Health check endpoint with server status and voice system information.</p>"},{"location":"api/#request_2","title":"Request","text":"<pre><code>curl http://localhost:8888/health\n</code></pre>"},{"location":"api/#response_2","title":"Response","text":"<pre><code>{\n  \"status\": \"healthy\",\n  \"port\": 8888,\n  \"voice_system\": \"Kokoro-82M\",\n  \"default_voice_id\": \"1\",\n  \"model_loaded\": true,\n  \"available_voices\": [\"1\", \"2\", \"3\", \"...\"]\n}\n</code></pre>"},{"location":"api/#response-fields","title":"Response Fields","text":"Field Type Description <code>status</code> string Server status (\"healthy\" or \"unhealthy\") <code>port</code> number Server port <code>voice_system</code> string TTS backend name <code>default_voice_id</code> string Default voice ID <code>model_loaded</code> boolean Whether TTS model is loaded <code>available_voices</code> array List of available voice IDs"},{"location":"api/#voice-ids","title":"Voice IDs","text":"<p>The server supports 41 built-in Kokoro voices accessed via numeric IDs (1-41).</p>"},{"location":"api/#popular-voices","title":"Popular Voices","text":"ID Voice Description 1 af_heart Warm, friendly (default) 4 af_sky Bright, energetic 12 am_michael Professional male 13 am_adam Youthful, energetic 21 bf_emma Sophisticated British"},{"location":"api/#voice-categories","title":"Voice Categories","text":"Category IDs Examples American Female 1-11 af_heart, af_sky, af_bella American Male 12-20 am_michael, am_adam, am_eric British Female 21-24 bf_emma, bf_isabella British Male 25-28 bm_george, bm_lewis Japanese 29-33 jf_alpha, jm_kumo Chinese 34-41 zf_xiaoxiao, zm_yunjian <p>See VOICE_QUICK_REF.md for complete voice listings.</p>"},{"location":"api/#configuration","title":"Configuration","text":""},{"location":"api/#environment-variables","title":"Environment Variables","text":"Variable Default Description <code>PORT</code> 8888 Server port <code>DEFAULT_VOICE_ID</code> 1 Default voice ID (1-41) <code>MLX_MODEL</code> mlx-community/Kokoro-82M-bf16 MLX model to use <code>MLX_STREAMING_INTERVAL</code> 0.3 Streaming chunk size (seconds) <code>ENABLE_MACOS_NOTIFICATIONS</code> true Enable macOS notifications"},{"location":"api/#example-configuration","title":"Example Configuration","text":"<pre><code># Set custom port\nexport PORT=9000\n\n# Set default voice\nexport DEFAULT_VOICE_ID=\"12\"\n\n# Start server with custom config\nPORT=9000 DEFAULT_VOICE_ID=\"12\" voice-server\n</code></pre>"},{"location":"api/#error-codes","title":"Error Codes","text":"Status Error Description 400 Bad Request Missing required fields 404 Not Found Invalid endpoint 500 Internal Error Server error"},{"location":"api/#error-response-format","title":"Error Response Format","text":"<pre><code>{\n  \"error\": \"Error message description\"\n}\n</code></pre>"},{"location":"api/#examples","title":"Examples","text":""},{"location":"api/#basic-notification","title":"Basic Notification","text":"<pre><code>curl -X POST http://localhost:8888/notify \\\n  -H \"Content-Type: application/json\" \\\n  -d '{\"message\": \"Hello, world!\", \"voice_id\": \"1\"}'\n</code></pre>"},{"location":"api/#custom-voice-and-speed","title":"Custom Voice and Speed","text":"<pre><code>curl -X POST http://localhost:8888/notify \\\n  -H \"Content-Type: application/json\" \\\n  -d '{\n    \"message\": \"This is a fast announcement\",\n    \"voice_id\": \"4\",\n    \"voice_settings\": {\"speed\": 1.2}\n  }'\n</code></pre>"},{"location":"api/#pai-agent-notification","title":"PAI Agent Notification","text":"<pre><code>curl -X POST http://localhost:8888/pai \\\n  -H \"Content-Type: application/json\" \\\n  -d '{\n    \"title\": \"Engineer Agent\",\n    \"message\": \"Code compilation successful\"\n  }'\n</code></pre>"},{"location":"api/#health-check","title":"Health Check","text":"<pre><code>curl http://localhost:8888/health\n</code></pre>"},{"location":"api/#integration-examples","title":"Integration Examples","text":""},{"location":"api/#python","title":"Python","text":"<pre><code>import requests\n\n# Send notification\nresponse = requests.post(\n    'http://localhost:8888/notify',\n    json={\n        'message': 'Hello from Python!',\n        'voice_id': '1'\n    }\n)\nprint(response.json())\n</code></pre>"},{"location":"api/#nodejsbun","title":"Node.js/Bun","text":"<pre><code>const response = await fetch('http://localhost:8888/notify', {\n  method: 'POST',\n  headers: { 'Content-Type': 'application/json' },\n  body: JSON.stringify({\n    message: 'Hello from Node.js!',\n    voice_id: '1'\n  })\n});\nconst result = await response.json();\nconsole.log(result);\n</code></pre>"},{"location":"api/#javascript-browser","title":"JavaScript (Browser)","text":"<pre><code>fetch('http://localhost:8888/notify', {\n  method: 'POST',\n  headers: { 'Content-Type': 'application/json' },\n  body: JSON.stringify({\n    message: 'Hello from browser!',\n    voice_id: '1'\n  })\n})\n.then(r =&gt; r.json())\n.then(console.log);\n</code></pre>"},{"location":"api/#see-also","title":"See Also","text":"<ul> <li>Voice Guide - Complete voice configuration</li> <li>Voice Quick Reference - All 41 voices</li> <li>Migration Guide - ElevenLabs migration</li> <li>README - Project documentation</li> </ul>"},{"location":"fifo-queue/","title":"FIFO Notification Queue","text":"<p>The voice server implements a FIFO (First-In-First-Out) queue for processing voice notifications sequentially, preventing audio overlap when multiple agents send notifications simultaneously.</p>"},{"location":"fifo-queue/#overview","title":"Overview","text":""},{"location":"fifo-queue/#what-problem-does-it-solve","title":"What Problem Does It Solve?","text":"<p>When multiple agents or processes send voice notifications simultaneously: - Before: Audio would overlap, making notifications unintelligible - After: Notifications are queued and played sequentially in order</p>"},{"location":"fifo-queue/#key-features","title":"Key Features","text":"<ul> <li>FIFO Processing: Notifications processed in the order they arrive</li> <li>Immediate Acknowledgment: Returns <code>201 Accepted</code> within 100ms</li> <li>Queue Monitoring: <code>GET /queue/status</code> endpoint for real-time status</li> <li>Graceful Shutdown: Queue drains before server exits</li> <li>Health Tracking: Monitors queue depth, processing status, and TTS health</li> </ul>"},{"location":"fifo-queue/#usage","title":"Usage","text":""},{"location":"fifo-queue/#sending-notifications","title":"Sending Notifications","text":"<p>Send a POST request to <code>/notify</code>:</p> <pre><code>curl -X POST http://localhost:8888/notify \\\n  -H \"Content-Type: application/json\" \\\n  -d '{\n    \"title\": \"Notification\",\n    \"message\": \"Your notification text here\",\n    \"voice_id\": \"marrvin\"\n  }'\n</code></pre> <p>Response: <pre><code>{\n  \"status\": \"success\",\n  \"message\": \"Notification accepted and queued\",\n  \"queuePosition\": 0,\n  \"itemId\": \"queue_1234567890_abc123\"\n}\n</code></pre></p>"},{"location":"fifo-queue/#queue-status-monitoring","title":"Queue Status Monitoring","text":"<p>Check queue status in real-time:</p> <pre><code>curl http://localhost:8888/queue/status\n</code></pre> <p>Response: <pre><code>{\n  \"status\": \"success\",\n  \"depth\": 3,\n  \"processingStatus\": \"active\",\n  \"health\": \"healthy\",\n  \"metrics\": {\n    \"itemsProcessed\": 42,\n    \"itemsFailed\": 0,\n    \"averageProcessingTimeMs\": 7100\n  }\n}\n</code></pre></p>"},{"location":"fifo-queue/#status-values","title":"Status Values","text":"<p>Queue Depth (<code>depth</code>) - Current number of notifications waiting to be processed - Maximum: 100 items</p> <p>Processing Status (<code>processingStatus</code>) - <code>idle</code>: Queue is empty, not processing - <code>active</code>: Currently processing a notification - <code>draining</code>: Processing remaining items (shutdown mode) - <code>stopped</code>: Queue not accepting new items</p> <p>Health Indicator (<code>health</code>) - <code>healthy</code>: Queue operating normally - <code>degraded</code>: Queue depth above threshold (50 items) - <code>unavailable</code>: TTS service failing</p>"},{"location":"fifo-queue/#response-codes","title":"Response Codes","text":"Code Meaning When Returned 201 Accepted Notification queued successfully 400 Bad Request Invalid request (missing fields, invalid data) 429 Too Many Requests Queue is full (100 items max) 500 Internal Error Server error occurred"},{"location":"fifo-queue/#configuration","title":"Configuration","text":"<p>Queue behavior can be configured via environment variables:</p> Variable Default Description <code>QUEUE_MAX_DEPTH</code> 100 Maximum queue depth <code>QUEUE_DRAIN_TIMEOUT_MS</code> 30000 Shutdown drain timeout (milliseconds) <code>QUEUE_DEGRADED_THRESHOLD</code> 50 Depth threshold for degraded health status"},{"location":"fifo-queue/#graceful-shutdown","title":"Graceful Shutdown","text":"<p>When the server receives a shutdown signal: 1. Sets status to \"draining\" 2. Stops accepting new notifications (returns 503) 3. Processes all remaining queued items 4. Waits up to 30 seconds for queue to drain 5. Logs remaining items if timeout occurs</p>"},{"location":"fifo-queue/#error-handling","title":"Error Handling","text":"<p>The queue uses a skip-on-failure pattern: - Failed notifications are marked as failed - Processing continues with next item - Failed items don't block the queue - Errors are logged for troubleshooting</p>"},{"location":"fifo-queue/#performance","title":"Performance","text":"<ul> <li>201 Response Time: &lt; 100ms (accepts request immediately)</li> <li>Queue Status Response: &lt; 50ms</li> <li>Processing Time: ~7 seconds per notification (includes TTS generation + playback)</li> </ul>"},{"location":"fifo-queue/#examples","title":"Examples","text":""},{"location":"fifo-queue/#single-notification","title":"Single Notification","text":"<pre><code>curl -X POST http://localhost:8888/notify \\\n  -H \"Content-Type: application/json\" \\\n  -d '{\"message\": \"Task completed\", \"voice_id\": \"marrvin\"}'\n</code></pre>"},{"location":"fifo-queue/#multiple-rapid-notifications","title":"Multiple Rapid Notifications","text":"<pre><code># Send 3 notifications rapidly\nfor i in {1..3}; do\n  curl -X POST http://localhost:8888/notify \\\n    -H \"Content-Type: application/json\" \\\n    -d \"{\\\"message\\\": \\\"Notification $i\\\", \\\"voice_id\\\": \\\"marrvin\\\"}\"\ndone\n</code></pre>"},{"location":"fifo-queue/#check-queue-status","title":"Check Queue Status","text":"<pre><code># Watch queue status in real-time\nwatch -n 1 'curl -s http://localhost:8888/queue/status | jq .'\n</code></pre>"},{"location":"fifo-queue/#troubleshooting","title":"Troubleshooting","text":""},{"location":"fifo-queue/#queue-not-processing","title":"Queue Not Processing","text":"<ol> <li>Check queue status: <code>curl http://localhost:8888/queue/status</code></li> <li>Verify <code>processingStatus</code> is not \"stopped\"</li> <li>Check server logs for errors</li> </ol>"},{"location":"fifo-queue/#notifications-not-playing","title":"Notifications Not Playing","text":"<ol> <li>Check TTS health status</li> <li>Verify voice_id is valid</li> <li>Check audio output device</li> </ol>"},{"location":"fifo-queue/#queue-full-429-response","title":"Queue Full (429 Response)","text":"<ol> <li>Wait for current queue to drain</li> <li>Check if notifications are completing slowly</li> <li>Consider increasing <code>QUEUE_MAX_DEPTH</code> if needed</li> </ol>"},{"location":"queue-architecture/","title":"Queue Architecture","text":"<p>Technical architecture of the FIFO notification queue system.</p>"},{"location":"queue-architecture/#system-overview","title":"System Overview","text":""},{"location":"queue-architecture/#data-models","title":"Data Models","text":""},{"location":"queue-architecture/#queuednotification","title":"QueuedNotification","text":"<pre><code>interface QueuedNotification {\n  id: string;                    // Unique identifier\n  request: NotificationRequest;  // Original request\n  status: QueuedItemStatus;       // pending | processing | completed | failed\n  arrivedAt: Date;                // When queued\n  processingStartedAt?: Date;    // When processing started\n  completedAt?: Date;            // When completed\n  error?: string;                 // Error message if failed\n}\n</code></pre>"},{"location":"queue-architecture/#queuestate","title":"QueueState","text":"<pre><code>interface QueueState {\n  depth: number;                    // Current queue depth\n  processingStatus: QueueProcessingStatus;\n  health: QueueHealth;               // healthy | degraded | unavailable\n  metrics: QueueMetrics;\n}\n\ninterface QueueMetrics {\n  itemsProcessed: number;          // Total processed\n  itemsFailed: number;             // Total failed\n  averageProcessingTimeMs: number; // Avg processing time\n}\n</code></pre>"},{"location":"queue-architecture/#request-flow","title":"Request Flow","text":""},{"location":"queue-architecture/#successful-notification-flow","title":"Successful Notification Flow","text":""},{"location":"queue-architecture/#error-handling-flow","title":"Error Handling Flow","text":""},{"location":"queue-architecture/#queue-states","title":"Queue States","text":""},{"location":"queue-architecture/#component-interactions","title":"Component Interactions","text":""},{"location":"queue-architecture/#notificationqueue-class","title":"NotificationQueue Class","text":"<pre><code>class NotificationQueue {\n  private queue: QueuedNotification[] = [];\n  private processingStatus: QueueProcessingStatus = \"idle\";\n  private isProcessing = false;\n  private ttsProcessor: TTSProcessor;\n\n  async enqueue(request): Promise&lt;EnqueueResult&gt; {\n    // 1. Validate request\n    // 2. Check queue depth\n    // 3. Add to queue\n    // 4. Start processing\n    // 5. Return 201 Accepted\n  }\n\n  getQueueState(): QueueState {\n    // Return current state\n  }\n\n  async drain(): Promise&lt;DrainResult&gt; {\n    // 1. Set status to draining\n    // 2. Wait for queue empty (30s timeout)\n    // 3. Stop accepting new items\n  }\n\n  private processQueue(): Promise&lt;void&gt; {\n    // Single worker processes items sequentially\n    while (queue.length &gt; 0 &amp;&amp; status !== \"stopped\") {\n      // Process item, handle errors, shift queue\n    }\n  }\n}\n</code></pre>"},{"location":"queue-architecture/#tts-processing-pipeline","title":"TTS Processing Pipeline","text":"<pre><code>async function processTTSWithMacOSNotification(request): Promise&lt;void&gt; {\n  // 1. Sanitize input\n  // 2. Resolve voice settings\n  3. Display macOS notification (optional)\n  // 4. Process TTS:\n  //    a. Generate audio with MLX-audio\n  //    b. Play with afplay\n  //    c. Clean up temp file\n}\n</code></pre>"},{"location":"queue-architecture/#performance-characteristics","title":"Performance Characteristics","text":""},{"location":"queue-architecture/#throughput","title":"Throughput","text":"<ul> <li>Accept Rate: ~10 requests/second (limited by queue depth)</li> <li>Processing Rate: ~1 notification/7 seconds</li> <li>Queue Depth: 100 items maximum</li> <li>Burst Capacity: Can handle bursts of rapid requests</li> </ul>"},{"location":"queue-architecture/#latency","title":"Latency","text":"<ul> <li>201 Response: &lt; 100ms (immediate acceptance)</li> <li>First Audio: ~7-10 seconds (TTS generation + playback starts)</li> <li>Complete Processing: ~7-10 seconds per notification</li> </ul>"},{"location":"queue-architecture/#resource-usage","title":"Resource Usage","text":"<ul> <li>Memory: ~1KB per queued item</li> <li>Disk: Temporary audio files (~100KB each, auto-cleaned)</li> <li>CPU: MLX-audio TTS generation (Apple Silicon optimized)</li> </ul>"},{"location":"queue-architecture/#security-considerations","title":"Security Considerations","text":""},{"location":"queue-architecture/#input-validation","title":"Input Validation","text":"<ul> <li>Title and message sanitized before TTS</li> <li>Voice ID validated against available voices</li> <li>Request size limits enforced</li> </ul>"},{"location":"queue-architecture/#rate-limiting","title":"Rate Limiting","text":"<ul> <li>Applied before queue admission</li> <li>Separate 429 response for queue full</li> <li>Per-client rate limits available</li> </ul>"},{"location":"queue-architecture/#error-isolation","title":"Error Isolation","text":"<ul> <li>Failed notifications don't block queue</li> <li>TTS failures logged but don't crash server</li> <li>Graceful degradation on errors</li> </ul>"},{"location":"queue-architecture/#monitoring","title":"Monitoring","text":""},{"location":"queue-architecture/#health-metrics","title":"Health Metrics","text":"<pre><code>{\n  \"depth\": 5,\n  \"processingStatus\": \"active\",\n  \"health\": \"healthy\",\n  \"metrics\": {\n    \"itemsProcessed\": 156,\n    \"itemsFailed\": 2,\n    \"averageProcessingTimeMs\": 7123\n  }\n}\n</code></pre>"},{"location":"queue-architecture/#health-indicators","title":"Health Indicators","text":"Health Condition healthy Queue depth &lt; 50, TTS working degraded Queue depth \u2265 50 OR slow processing unavailable TTS failures &gt; 50% of requests"},{"location":"queue-architecture/#logging","title":"Logging","text":"<p>Key log messages for monitoring:</p> <ul> <li><code>Notification queued</code> - New item added</li> <li><code>Processing queued notification</code> - Processing started</li> <li><code>Notification processed successfully</code> - Item completed</li> <li><code>Notification processing failed</code> - Item failed</li> <li><code>Queue drain complete</code> - Shutdown complete</li> </ul>"}]}